$(function () {
    // Admin Panel settings

    //****************************
    /* This is for the mini-sidebar if width is less then 1170*/
    //****************************
    var setsidebartype = function () {
        var width =
            window.innerWidth > 0 ? window.innerWidth : this.screen.width;
        if (width < 1199) {
            $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
            $("#main-wrapper").addClass("mini-sidebar");
        } else {
            $("#main-wrapper").attr("data-sidebartype", "full");
            $("#main-wrapper").removeClass("mini-sidebar");
        }
    };
    $(window).ready(setsidebartype);
    $(window).on("resize", setsidebartype);
    //****************************
    /* This is for sidebartoggler*/
    //****************************
    $(".sidebartoggler").on("click", function () {
        $("#main-wrapper").toggleClass("mini-sidebar");
        if ($("#main-wrapper").hasClass("mini-sidebar")) {
            $(".sidebartoggler").prop("checked", !0);
            $("#main-wrapper").attr("data-sidebartype", "mini-sidebar");
        } else {
            $(".sidebartoggler").prop("checked", !1);
            $("#main-wrapper").attr("data-sidebartype", "full");
        }
    });
    $(".sidebartoggler").on("click", function () {
        $("#main-wrapper").toggleClass("show-sidebar");
    });
});

// Preloader Script Starts

function fade(element) {
    var op = 1; // initial opacity
    var timer = setInterval(function () {
        if (op <= 0.1) {
            clearInterval(timer);
            element.style.display = "none";
        }
        element.style.opacity = op;
        element.style.filter = "alpha(opacity=" + op * 100 + ")";
        op -= op * 0.1;
    }, 50);
}
window.onload = function () {
    let preloader = document.querySelector("#preloader");
    // let loader = preloader.querySelector(".loader");
    // fade(loader);
    fade(preloader);
};

// Preloader Script Ends
document.addEventListener("DOMContentLoaded", () => {
    const preloader = document.getElementById("preloader-login");
    const textElements = document.querySelectorAll(
        "#preloader-login .text:not(.loading)"
    );
    const loadingText = document.querySelector(
        "#preloader-login .text.loading"
    );
    let currentIndex = 0;
    let allTextsDisplayed = false;

    // Function to display each <p> tag one by one with fade-in and fade-out effect
    const showText = () => {
        if (currentIndex < textElements.length) {
            const currentText = textElements[currentIndex];

            // Fade in the current text
            currentText.style.display = "block";
            currentText.style.opacity = 1;

            setTimeout(() => {
                // Fade out the current text
                currentText.style.opacity = 0;
                currentText.style.display = "none";

                currentIndex++;
                setTimeout(showText, 100); // Move to the next text after fade-out
            }, 700); // Keep the text visible for 1 second
        } else {
            allTextsDisplayed = true;
            loadingText.style.display = "block"; // Show "Loading..." if content isn't ready
            checkCompletion();
        }
    };

    // Check if content is loaded
    const checkCompletion = () => {
        if (document.readyState === "complete" && allTextsDisplayed) {
            fadeOutPreloader();
        } else {
            setTimeout(checkCompletion, 500); // Check again after 500ms
        }
    };

    // Fade out the preloader
    const fadeOutPreloader = () => {
        preloader.style.transition = "opacity 0.5s ease";
        preloader.style.opacity = "0";
        setTimeout(() => {
            preloader.style.display = "none";
        }, 500); // Match the transition duration
    };

    // Start the preloader animation
    showText();
});
